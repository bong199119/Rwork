seq
seq(1,10, 3)
seq
vec2 <- seq(1,10, 3)
vec2
vec1 <- c(1:5)
vec3 <- c(vec1, vec2)
vec4 <- c(vec1, vec2)
vec4
#3) Vec3 벡터 변수에 "R" 문자가 5회 반복되도록 하시오.
vec3 <- rep("r", 5)
vec3
seq(25,-15, by=5)
m <- rbind(v1,v2)
m
# 02. 다음 두 개의 벡터를 이용하여 단계별로 처리하시오.
v1 <- c(2,3,10,-5,8)
v2 <- c(40,50,-30,7,10)
m <- rbind(v1,v2)
m
dim(m)
m<- cbind(v1,v2)
m
seq(25,-15, -5)
vec5 <- vec4[seq(1,length(vec4),2)]
vec5
apply(m,2,sum)
# <조건1> 위 7개 벡터를 user이름으로 데이터 프레임 생성
user <- data.frame(name, age, gender,job,sat,grade,total)
name <-c("최민수","유관순", "이순신","김유신","홍길동")
age <-c(55,45,45,53,15) #연령
gender <-c(1,2,1,1,1) #1:남자, 2: 여자
job <-c("연예인","주부","군인","직장인","학생")
sat <-c(3,4,2,5,5) # 만족도
grade <- c("C","C","A","D","A")
total <-c(44.4,28.5,43.5,NA,27.1) #총구매금액(NA:결측치)
# <조건1> 위 7개 벡터를 user이름으로 데이터 프레임 생성
user <- data.frame(name, age, gender,job,sat,grade,total)
user
# <조건2> 총구매금액(total) 변수를 이용하여 히스토그램 그리기-hist()
hist(user$total)
# <조건3> 만족도(sat) 변수를 이용하여 산점도 그리기-plot()
plot(user$sat)
kor <- c(90,85,90)
eng <- c(70,85,75)
mat <- c(86,92,88)
# 조건1) 3개의 과목점수를 이용하여 데이터프레임(Data)을 생성한다.
data<- data.frame(kor,eng,mat)
data
# 조건2) 행/열 방향으로 max()함수를 적용하여 최댓값 구하기
apply(data,1,max)
apply(data,2,max)
# 조건3) 행/열 방향으로 mean()함수를 적용하여 평균 구하기(소숫점 2자리 까지 표현)
#  힌트 : round(data, 자릿수)
round(apply(data,1,mean),2)
round(apply(data,2,mean),2)
score <- c(90,85,83)
# 분산
var(score)
# 분산
var(score) # 13
# 표준편차 : 분산의 양의 제곱근
sd(score)
# 표준편차 : 분산의 양의 제곱근
sd(score) # 3.605551
sqrt(var(score))
sqrt(var(score)) # 3.605551
#분산 = sum((x-산술평균)^2) / n-1
avg <- mean(score) # 산술평균
diff <- (score - avg)
diff <- (score - avg)^2
diff
diff <- (score - avg)^2
diff_sum <- sum(diff)
var <- diff_sum / (length(score) - 1)
var
sd <- sqrt(var)
sd
# 1) key 생략 : [key =] value
list <- list('lee',"이순신",29,"hong","홍길동",45)
# key -> value 접근
list[[1]] -> "lee"의 키값
# key -> value 접근
list[[1]]  #-> "lee"의 key
list[[2]]  #-> "이순신"의 key
# index -> key:value 접근
list[4] # -> [[4]],  "hong"
install.packages("stringr")
library(stringr)
str <- "홍길동35이순신45"
str_extract_all(str, "[가-힣]{3}")
member = list(name = c("홍길순", "이순신"),
age = c(33,44),
gender = ㅊ("여","남"))
member
member = list(name = c("홍길순", "이순신"),
age = c(33,44),
gender = c("여","남"))
member
member$name[2]
# 조건4) 행 단위 분산과 표준편차 구하기
#  힌트 : var(), sd()
apply(Data, 1, var)
apply(Data, 1, sd)
# 1. 모집단에서 표본 추출(1,000 학생)
x <- rnorm(1000, mean = 165.2, sd = 1) # 정규분포
hist(x)
# 정규성 결정
# 귀무가설 : 정규분포와 차이가 없다.
shapiro.test(x)
# 2. 평균차이 검정 : 평균 : 165.2cm
t.test(x, mu=165.2)
# t = -0.55503, df = 999, p-value = 0.579
# t, df : 검정통계량
# p-value : 유의확률
# p-value = 0.579 >= 0.05 -> 귀무가설 채택
# 95 percent confidence interval: 95%
# 165.1071 ~ 165.2309 : 신뢰구간(채택역)
# mean of x
# 165.1832 -> 실제 평균
mean(x)
# t = -0.55503, df = 999, p-value = 0.579
# t, df : 검정통계량
# p-value : 유의확률
# p-value = 0.579 >= 0.05 -> 귀무가설 채택
# 95 percent confidence interval: 95%
# 165.1071 ~ 165.2309 : 신뢰구간(채택역)
# mean of x
# 165.169 -> 실제 평균
mean(x) # 165.169
# 3. 기각역의 평균검정
t.test(x, mu=165.09, conf.level = 0.95) # 95%
# 4. 신뢰수준 변경(95% -> 99%)
t.test(x, mu=165.2, conf.level = 0.99)
# 정규붙포
n <- 2000
rnorm(n, mean = 100, sd = 10)
x <- rnorm(n, mean = 100, sd = 10)
x
shapiro.test(x)
# 표준화
# 표준화 공식(z) = (x - mu) / sd(x)
mu <- mean(x)
# 표준화
# 표준화 공식(z) = (x - mu) / sd(x)
mu <- mean(x)
mu
z = (x - mu) / sd(x)
z
hist(z)
mean(z)
sd(z) # 1
?sd
# scale() 함수 이용
z2 <- as.data.frame(scale(x)) # matrix -> data.frame
z2
str(z2)
z2 <- z2$V1
hist(z2)
z2
mean(z2) # # 6.1
sd(z2)
# 2. 정규화
# - 특정 변수값을 일정한 범위(0 ~ 1)로 일치시키는 과정
str(iris)
head(iris)
summary(iris[-5])
# 정규화 -> data.frame 형변환
as.data.frame(scale(iris[-5]))
# 정규화 -> data.frame 형변환
iris_nor <- as.data.frame(scale(iris[-5]))
summary(iris_nor)
summary(iris[-5])
summary(iris_nor)
# 2) 정규화 함수 정의(0~1)
nor <- function(x){
n <- (x - min(x)) / (max(x) - min(x))
return (n)
}
iris_nor2 <- apply(iris[-5], 2, nor)
summary(iris_nor2)
head(iris_nor2)
df <- data.frame(no, score)
no <- 1:100 # 번호
score <- runif(100, min = 40, max = 100) # 성적
df <- data.frame(no, score)
df
nrow(df)
# 15명 학생 샘플링
sample(x = nrow(df), size = 15)
# 15명 학생 샘플링
idx <- sample(x = nrow(df), size = 15)
idx
sam <- df[idx, ]
sam
# train(70%)/test(30%) dataset
idx <- sample(x = nrow(df), size = nrow(df)*0.7)
idx
train <- df[idx, ]
test <- df[-idx, ]
dim(train)
dim(test)
# 05. iris 데이터셋을 대상으로 8:2비율로 sampling하여 train과 test 셋을 만드시오.
dim(iris)
nrow(iris)
idx <- sample(x = nrow(iris), size = nrow(iris)*0.8)
idx
dim(iris)
dim(idx)
train <- df[idx, ]
dim(train)
test <- df[-idx, ]
dim(test)
train <- iris[idx, ]
test <- iris[-idx, ]
dim(train)
dim(test)
# 50% vs 50%
idx <- sample(nrow(iris), nrow(iris)*0.5)
train <- iris[idx, ]
test <- iris[-idx, ]
dim(train)
dim(test)
head(iris)
# Sepal.Length : y(종속변수)
# Petal.Length : x(독립변수)
# model : 꽃잎 길이 -> 꽃받침 길이
model <- lm(Sepal.Length ~ Petal.Length, data = train )
pred <- model$fitted.values # 예측치(꽃받침 길이)
pred
# test ataset model
model2 <- lm(Sepal.Length ~ Petal.Length, data= test)
pred2 <- model2$fitted.values
# train_y
train_x <- train$Sepal.Length # train 정답
# test_y
test_x <- test$Sepal.Length # test 정답
# 정답 vs 예측치
plot(train_x, pred, col="blue", pch=18) # plot(x,y)
points(test_x, pred2, col="red",pch-19)
# 정답 vs 예측치
plot(train_x, pred, col="blue", pch=18) # plot(x,y)
points(test_x, pred2, col="red",pch-19)
points(test_x, pred2, col="red",pch=19)
col = c("blue", "red"), pch = c(18,19)
# 범례
legend("topleft", legend = c("train", "test"),
col = c("blue", "red"), pch = c(18,19))
plot(train_x,pred2)
plot(train_x,pred)
# train_y
train_x <- train$Petal.Length # train 정답
# 정답 vs 예측치
plot(train_x, pred, col="blue", pch=18) # plot(x,y)
# test_y
test_x <- test$Petal.Length # test 정답
points(test_x, pred2, col="red",pch=19) #
plot(train_x,pred)
# 정답 vs 예측치
plot(train_x, pred, col="blue", pch=18) # plot(x,y)
points(test_x, pred2, col="red",pch=19) #
pred
# train_y
train_x <- train$Sepal.Length # train 정답
# test_y
test_x <- test$Sepal.Length # test 정답
plot(train_x, test_x, col="blue", pch=18) # plot(x,y)
points(pred, pred2, col="red",pch=19) #
# train_y
train_x <- train$Petal.Length # train 정답
# 정답 vs 예측치
plot(train_x, pred, col="blue", pch=18) # plot(x,y)
test_y <- test$Petal.Length
points(test_x, test_y, col="red",pch=19) #
# test_y
test_x <- test$Petal.Length # test 정답
test_y <- test$Sepal.Length
plot(train_x, pred, col="blue", pch=18) # plot(x,y)
points(test_x, test_y, col="red",pch=19) #
pred
model
# 3) 산점도 시각화
price <- runif(10, min =1, max =100)
price
plot(price) # 하나만 넣으면 y에 들어감, x축에는 index
par(mfrow=c(2,2))
plot(price, type="o") # circle
plot(price, type="l") # line
plot(price, type="h") # height
plot(price, type="s") # step
# 빈도수 확인
table(gender)
dataset
# 실습 데이터 파일 가져오기
setwd("c:/rwork/data/")
dataset <- read.csv("dataset.csv")
str(dataset)
type <- rep(1:3, 100)
type
# 칼럼 추가
dataset$type <- type
head(dataset)
price4 <- 0 # 통계적 방법
for(i in 1:nrow(dataset)){ # index : 300 반복
if(is.na(dataset$price[i])){
if(dataset$type[i] == 1 ){
price4[i] = avg*1.5
}else if(dataset$type[i] == 2){
price4[i] = avg
}else{
price4[i] = avg*0.5
}
}else{ # NOT NA
price4[i] <- dataset$price[i]
}
}
# (1) 범주형(명목, 서열) 극단치 처리
gender <- dataset$gender
gender
# 빈도수 확인
table(gender)
pie(table(gender))
# 1. 모집단에서 표본 추출(1,000 학생)
x <- rnorm(1000, mean = 165.2, sd = 1) # 정규분포
hist(x)
par(mfrow=c(1,1))
hist(x)
# 정규성 결정
# 귀무가설 : 정규분포와 차이가 없다. (0)
shapiro.test(x)
# 2. 평균차이 검정 : 평균 : 165.2cm
t.test(x, mu=165.2)
# 3. 기각역의 평균검정
t.test(x, mu=165.09, conf.level = 0.95) # 95%
# 정규붙포
n <- 2000
x <- rnorm(n, mean = 100, sd = 10)
x
shapiro.test(x)
# 표준화
# 표준화 공식(z) = (x - mu) / sd(x)
mu <- mean(x) #  99.79778
mu
z = (x - mu) / sd(x)
z
# 2. 정규화(스케일링)
# - 특정 변수값을 일정한 범위(0 ~ 1)로 일치시키는 과정
str(iris)
head(iris)
summary(iris[-5])
# 1) scale() 함수
# 정규화 -> data.frame 형변환
iris_nor <- as.data.frame(scale(iris[-5]))
summary(iris_nor)
# scale() 함수 이용
z2 <- as.data.frame(scale(x)) # matrix -> data.frame
z2
str(z2)
# 2. 정규화(스케일링)
# - 특정 변수값을 일정한 범위(0 ~ 1)로 일치시키는 과정
str(iris)
head(iris)
summary(iris[-5])
# 1) scale() 함수
# 정규화 -> data.frame 형변환
iris_nor <- as.data.frame(scale(iris[-5]))
# 1) scale() 함수
# 정규화 -> data.frame 형변환
iris_nor <- as.data.frame(scale(iris[-5]))
summary(iris_nor)
iris_nor2 <- apply(iris[-5], 2, nor)
summary(iris_nor2)
?sample
# 15명 학생 샘플링
idx <- sample(x = nrow(df), size = 15)
idx
# train(70%)/test(30%) dataset
idx <- sample(x = nrow(df), size = nrow(df)*0.7)
idx
train <- df[idx, ] # model 학습용
test <- df[-idx, ] # model 평가용
dim(train) # 70  2
dim(test) # 30  2
no <- 1:100 # 번호
score <- runif(100, min = 40, max = 100) # 성적
df <- data.frame(no, score)
df
nrow(df) # 100
# 15명 학생 샘플링
idx <- sample(x = nrow(df), size = 15)
idx
sam <- df[idx, ]
sam
# train(70%)/test(30%) dataset
idx <- sample(x = nrow(df), size = nrow(df)*0.7)
idx
# 실습파일 가져오기
setwd("c:/Rwork/data")
data <- read.csv("cleanDescriptive.csv")
str(data)
# 변수 선택
x <- data$level2 # 학력수준
y <- data$pass2 # 합격유무
table(x)
#   고졸   대졸   대학원졸
#    93     86         57
table(y)
#   고졸   대졸   대학원졸
#    93     86         57
table(y)
df <- data.frame(Level = x, Pass = y)
# 1) 교차분할표
table(df$Level, df$Pass) # (행, 열)
# 2) package 이용
install.packages("gmodels")
library(gmodels)
library(gmodels)
library(help = "gmodels")
CrossTable(x=df$Level, y=df$Pass)
CrossTable(x=df$Level, y=df$Pass, chisq = TRUE)
chisq.test(c(4,6,17,16,8,9))
# (2) 선호도 분석
#-----------------------------------------
# 귀무가설 : 기대치와 관찰치는 차이가 없다.
# 대립가설 : 기대치와 관찰치는 차이가 있다.
#-----------------------------------------
data <- textConnection(
"스포츠음료종류  관측도수
1   41
2   30
3   51
4   71
5   61
")
T
x <- read.table(data, header=T)
x # 스포츠음료종류 관측도수
chisq.test(x$관측도수)
# 독립변수(x)와 종속변수(y) 생성
setwd("c:/Rwork/data")
data <- read.csv("cleanDescriptive.csv")
str(data)
x <- data$level2 # 부모의 학력수준
y <- data$pass2 # 자녀의 대학진학여부
CrossTable(x, y, chisq = TRUE) #p =  0.2507057
# 1. 파일 가져오기
data <- read.csv("homogenity.csv", header=TRUE)
head(data)
table(data$method)
table(data$survey)
# method와 survery 변수만 서브셋 생성
data <- subset(data, !is.na(survey), c(method, survey))
data
# 교육방법2 필드 추가
data$method2[data$method==1] <- "방법1"
data$method2[data$method==2] <- "방법2"
data$method2[data$method==3] <- "방법3"
# 만족도2 필드 추가
data$survey2[data$survey==1] <- "매우만족"
data$survey2[data$survey==2] <- "만족"
data$survey2[data$survey==3] <- "보통"
data$survey2[data$survey==4] <- "불만족"
data$survey2[data$survey==5] <- "매우불만족"
# 3. 교차분할표 작성
table(data$method2, data$survey2)  # 교차표 생성 -> table(행,열)
# 4. 동질성 검정 - 모수 특성치에 대한 추론검정
chisq.test(data$method2, data$survey2)
str(iris)
# x, y 변수 선택
x <- iris$Species
y <- iris$Sepal.Length
chisq.test(x, y)
table(x)
install.packages("dplyr")
library(dplyr)
# dataset %>% function()  %>% <- 줄바꿈 안하고도 연속해서 연산해주는것
iris %>% group_by(Species) %>% summarise(avg = mean(Sepal.Length))
# dataset %>% function()  %>% <- 줄바꿈 안하고도 연속해서 연산해주는것
iris %>% group_by(Species) %>% summarise(avg = mean(Sepal.Length))
library(dplyr)
# dataset %>% function()  %>% <- 줄바꿈 안하고도 연속해서 연산해주는것
iris %>% group_by(Species) %>% summarise(avg = mean(Sepal.Length))
# dataset %>% function()  %>% <- 줄바꿈 안하고도 연속해서 연산해주는것
iris %>% group_by(Species) %>% summarise(avg = mean(Sepal.Length))
table(x)
chisq.test(x, y)
library(dplyr)
iris %>% group_by(Species) %>% summarise(avg = mean(Sepal.Length))
# dataset 가져오기
getwd()
setwd("C:/Rwork/data")
product <- read.csv("product.csv")
# 친밀도, 적절성, 만족도 : 5점(등간척도)
str(product)
corr <- cor(product, method = "pearson") # 상관계수 행렬
corr <- cor(product, method = "pearson") # 상관계수 행렬
cor(x= product$제품_적절성, y = product$제품_만족도)
# 2. 상관분석 시각화
install.packages("corrplot")
library(corrplot)
corrplot(corr, method = "number")
install.packages("PerformanceAnalytics")
library(PerformanceAnalytics)
chart.Correlation(product)
###############
## iris 적용
###############
cor(iris[-5])
# 양의 상관계수(0.9628654)
plot(iris$Petal.Length, iris$Petal.Width)
# 음의 상관계수(-0.4284401)
plot(iris$Petal.Length, iris$Sepal.Width)
